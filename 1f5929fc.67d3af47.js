(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{132:function(e,t,r){"use strict";r.r(t),t.default=r.p+"assets/images/docs-usage-template-docx-no_comments-4c884633e371c46b0a4cff9b1b304085.png"},133:function(e,t,r){"use strict";r.r(t),t.default=r.p+"assets/files/personal_data_sheet_v1_3-1bce9ef51708a64afde57c29b5a2a316.docx"},134:function(e,t,r){"use strict";r.r(t),t.default=r.p+"assets/images/docs-usage-template-docx-commented-9a57c090d08509b785ae623fb95fb875.png"},135:function(e,t,r){"use strict";r.r(t),t.default=r.p+"assets/files/personal_data_sheet_v1_3-template-350c81a4942c7db9950a5f1a077d9e55.docx"},136:function(e,t,r){"use strict";r.r(t),t.default=r.p+"assets/files/template-utils-a0139ea6d04802b7f5a01c62b8761020.properties"},74:function(e,t,r){"use strict";r.r(t),r.d(t,"frontMatter",(function(){return i})),r.d(t,"metadata",(function(){return l})),r.d(t,"toc",(function(){return s})),r.d(t,"default",(function(){return p}));var n=r(3),o=r(7),a=(r(0),r(90)),i={id:"usage",title:"Usage",slug:"/getting-started/usage/"},l={unversionedId:"getting-started/usage",id:"getting-started/usage",isDocsHomePage:!1,title:"Usage",description:"Currently, typed pojo DTOs are supported, thus you will need to add the generator to the project where",source:"@site/docs/getting-started/usage.md",slug:"/getting-started/usage/",permalink:"/template-utils/docs/getting-started/usage/",editUrl:"https://github.com/videki/template-utils/docs/getting-started/usage.md",version:"current",sidebar:"docs",previous:{title:"Overview",permalink:"/template-utils/docs/getting-started/overview"},next:{title:"Architecture",permalink:"/template-utils/docs/documentation/architecture"}},s=[{value:"How it works",id:"how-it-works",children:[]}],c={toc:s};function p(e){var t=e.components,i=Object(o.a)(e,["components"]);return Object(a.b)("wrapper",Object(n.a)({},c,i,{components:t,mdxType:"MDXLayout"}),Object(a.b)("p",null,"Currently, typed pojo DTOs are supported, thus you will need to add the generator to the project where\nyou would like to generate your documents."),Object(a.b)("p",null,"For a showcase suppose the HR at your company uses the following document to summarize basic employee data:"),Object(a.b)("p",null,Object(a.b)("img",{alt:"docx template",src:r(132).default}),"\n(download: ",Object(a.b)("a",{target:"_blank",href:r(133).default},"personal_data_sheet_v1_3.docx"),")"),Object(a.b)("h2",{id:"how-it-works"},"How it works"),Object(a.b)("p",null,"(In this example we assume a java project)"),Object(a.b)("ol",null,Object(a.b)("li",{parentName:"ol"},"Construct the DTO you will use within the templates")),Object(a.b)("p",null,"As we can see in the form (and spec., etc. of course) we got, we have the provide the properties below\n(in most cases we will have these classes in our business logic already done):"),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre",className:"language-java"},"package net.videki.templateutils.template.test.dto.contract;\n\nimport lombok.AllArgsConstructor;\nimport lombok.Data;\nimport net.videki.templateutils.template.core.dto.ITemplate;\n\nimport java.time.LocalDate;\n\n@Data\n@AllArgsConstructor\npublic class Person implements ITemplate {\n    private String name;\n    private LocalDate birthDate;\n    private LocalDate signDate;\n}\n")),Object(a.b)("p",null,"Implementing the ",Object(a.b)("code",null,"ITemplate")," interface is optional, it provides convenience functions\nyou can use in your templates."),Object(a.b)("ol",{start:2},Object(a.b)("li",{parentName:"ol"},"Markup the template")),Object(a.b)("p",null,"Now, add the control to the template:  "),Object(a.b)("p",null,Object(a.b)("img",{alt:"decorated docx template",src:r(134).default}),"\n(download: ",Object(a.b)("a",{target:"_blank",href:r(135).default},"personal_data_sheet_v1_3-template.docx"),")"),Object(a.b)("ol",{start:3},Object(a.b)("li",{parentName:"ol"},"Add maven dependency")),Object(a.b)("p",null,"Maven:"),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre",className:"language-xml"},"  <dependency>\n    <groupId>net.videki.template-utils</groupId>\n    <artifactId>template-utils-core</artifactId>\n    <version>1.0.1</version>\n  </dependency>\n")),Object(a.b)("p",null,"Gradle:"),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre",className:"language-groovy"},"  compile group: 'net.videki.template-utils', name: 'template-utils-core', version: '1.0.1'\n")),Object(a.b)("ol",{start:4},Object(a.b)("li",{parentName:"ol"},"Add the generator config (template-utils.properties) to the project resources")),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre",className:"language-properties"},"# Document structure repository provider\nrepository.documentstructure.provider=net.videki.templateutils.template.core.provider.documentstructure.repository.filesystem.FileSystemDocumentStructureRepository\nrepository.documentstructure.builder=net.videki.templateutils.template.core.provider.documentstructure.builder.yaml.YmlDocStructureBuilder\nrepository.documentstructure.provider.basedir=documentstructures\n\n# Template repository provider class\nrepository.template.provider=net.videki.templateutils.template.core.provider.templaterepository.filesystem.FileSystemTemplateRepository\nrepository.template.provider.basedir=templates\n\n# InputTemplate processors\nprocessors.docx=net.videki.templateutils.template.core.processor.input.docx.DocxStamperInputTemplateProcessor\nprocessors.xlsx=net.videki.templateutils.template.core.processor.input.xlsx.JxlsInputTemplateProcessor\n\n# Result repository provider class\nrepository.result.provider=net.videki.templateutils.template.core.provider.resultstore.filesystem.FileSystemResultStore\nrepository.result.provider.basedir=generated-documents\n\n# Font base directory\nconverter.pdf.font-library.basedir=/fonts\n")),Object(a.b)("p",null,"(download: ",Object(a.b)("a",{target:"_blank",href:r(136).default},"template-utils.properties"),")"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},"The ",Object(a.b)("code",null,"repository.documentstructure.provider.basedir")," property specifies the template root location.\nThis can be also set to an external location containing the templates.",Object(a.b)("br",{parentName:"li"}),"There is a helper class to handle folders within this doc root and provide full path for the template as shown\nin the code below (see ",Object(a.b)("code",null,"FileSystemHelper.getFileNameWithPath(inputDir, fileName)"),")."),Object(a.b)("li",{parentName:"ul"},"The ",Object(a.b)("code",null,"repository.result.provider.basedir")," property specifies the result root location.\nBy default the basedir root is the output dir with the template name.\nThis can be overridden by specifying the generation behaviour with ",Object(a.b)("code",null,"DocumentStructure"),".")),Object(a.b)("ol",{start:5},Object(a.b)("li",{parentName:"ol"},"Add the document generator functionality to the business logic")),Object(a.b)("p",null,"The sample code below shows a simple fill-and-save scenario to the output dir, but the result can also be requested\nas a stream. See the ",Object(a.b)("code",null,"TemplateService")," interface for more information."),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre",className:"language-java"},'package net.videki.templateutils.examples;\n\nimport net.videki.templateutils.examples.singletemplatepojo.dto.Person;\nimport net.videki.templateutils.template.core.service.TemplateServiceRegistry;\nimport net.videki.templateutils.template.core.service.exception.TemplateServiceException;\nimport net.videki.templateutils.template.core.util.FileSystemHelper;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\nimport java.time.LocalDate;\nimport java.time.Month;\n\npublic class SingleTemplateDocxPojo {\n    private static final Logger LOGGER = LoggerFactory.getLogger(SingleTemplateDocxPojo.class);\n\n    // Only to demonstrate the usage  \n    public static void main(String[] args) {\n        final SingleTemplateDocxPojo appService = new SingleTemplateDocxPojo();\n\n        appService.generateDocs();\n    }\n\n    public void generateDocs() {\n        final String inputDir = "hr-files";\n        final String fileName = "personal_data_sheet_v1_3-template.docx";\n\n        final var data = getTemplateData();\n\n        try {\n            TemplateServiceRegistry.getInstance().fillAndSave(\n                    FileSystemHelper.getFileNameWithPath(inputDir, fileName),\n                    data);\n\n        } catch (final TemplateServiceException e) {\n            LOGGER.error("Error generating the result doc.", e);\n        }\n\n    }\n\n    private Person getTemplateData() {\n        // Mocking the business logic\n        return new Person("John Doe",\n                LocalDate.of(1970, Month.JULY, 20),\n                LocalDate.of(2020, Month.NOVEMBER, 1));\n    }\n}\n')),Object(a.b)("p",null,"Done."))}p.isMDXComponent=!0},90:function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return b}));var n=r(0),o=r.n(n);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var c=o.a.createContext({}),p=function(e){var t=o.a.useContext(c),r=t;return e&&(r="function"==typeof e?e(t):l(l({},t),e)),r},u=function(e){var t=p(e.components);return o.a.createElement(c.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.a.createElement(o.a.Fragment,{},t)}},m=o.a.forwardRef((function(e,t){var r=e.components,n=e.mdxType,a=e.originalType,i=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),u=p(r),m=n,b=u["".concat(i,".").concat(m)]||u[m]||d[m]||a;return r?o.a.createElement(b,l(l({ref:t},c),{},{components:r})):o.a.createElement(b,l({ref:t},c))}));function b(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var a=r.length,i=new Array(a);i[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:n,i[1]=l;for(var c=2;c<a;c++)i[c]=r[c];return o.a.createElement.apply(null,i)}return o.a.createElement.apply(null,r)}m.displayName="MDXCreateElement"}}]);