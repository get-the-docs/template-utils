(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{132:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/docs-usage-template-docx-no_comments-4c884633e371c46b0a4cff9b1b304085.png"},133:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/files/personal_data_sheet_v1_3-1bce9ef51708a64afde57c29b5a2a316.docx"},134:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/docs-usage-template-docx-commented-9a57c090d08509b785ae623fb95fb875.png"},135:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/files/personal_data_sheet_v1_3-template-350c81a4942c7db9950a5f1a077d9e55.docx"},136:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/files/template-utils-a0139ea6d04802b7f5a01c62b8761020.properties"},137:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/docs-getting_started-docstructure-cover-result-large-0cb340323e5a87b6f11ba7d5a4a210f2.png"},138:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/docs-getting_started-docstructure-contract-result-large-1cbc087b7a71e88093ad288af0d5ed9c.png"},139:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/docs-getting_started-docstructure-terms-result-large-2c1cf66dce628e0378393b50c1106453.png"},74:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return l})),n.d(t,"metadata",(function(){return i})),n.d(t,"toc",(function(){return c})),n.d(t,"default",(function(){return u}));var a=n(3),r=n(7),o=(n(0),n(90)),l={id:"usage",title:"Usage",slug:"/getting-started/usage/"},i={unversionedId:"getting-started/usage",id:"getting-started/usage",isDocsHomePage:!1,title:"Usage",description:"Currently, typed pojo DTOs are supported, thus you will need to add the generator to the project where",source:"@site/docs/getting-started/usage.md",slug:"/getting-started/usage/",permalink:"/template-utils/docs/getting-started/usage/",editUrl:"https://github.com/videki/template-utils/docs/getting-started/usage.md",version:"current",sidebar:"docs",previous:{title:"Overview",permalink:"/template-utils/docs/getting-started/overview"},next:{title:"Architecture",permalink:"/template-utils/docs/documentation/architecture"}},c=[{value:"How it works",id:"how-it-works",children:[]},{value:"Dealing with multiple documents in a workflow",id:"dealing-with-multiple-documents-in-a-workflow",children:[]}],s={toc:c};function u(e){var t=e.components,l=Object(r.a)(e,["components"]);return Object(o.b)("wrapper",Object(a.a)({},s,l,{components:t,mdxType:"MDXLayout"}),Object(o.b)("p",null,"Currently, typed pojo DTOs are supported, thus you will need to add the generator to the project where\nyou would like to generate your documents."),Object(o.b)("p",null,"For a showcase suppose the HR at your company uses the following document to summarize basic employee data:"),Object(o.b)("p",null,Object(o.b)("img",{alt:"docx template",src:n(132).default}),"\n(download: ",Object(o.b)("a",{target:"_blank",href:n(133).default},"personal_data_sheet_v1_3.docx"),")"),Object(o.b)("h2",{id:"how-it-works"},"How it works"),Object(o.b)("p",null,"(In this example we assume a java project)"),Object(o.b)("ol",null,Object(o.b)("li",{parentName:"ol"},"Construct the DTO you will use within the templates")),Object(o.b)("p",null,"As we can see in the form (and spec., etc. of course) we got, we have the provide the properties below\n(in most cases we will have these classes in our business logic already done):"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-java"},"package net.videki.templateutils.template.test.dto.contract;\n\nimport lombok.AllArgsConstructor;\nimport lombok.Data;\nimport net.videki.templateutils.template.core.dto.ITemplate;\n\nimport java.time.LocalDate;\n\n@Data\n@AllArgsConstructor\npublic class Person implements ITemplate {\n    private String name;\n    private LocalDate birthDate;\n    private LocalDate signDate;\n}\n")),Object(o.b)("p",null,"Implementing the ",Object(o.b)("code",null,"ITemplate")," interface is optional, it provides convenience functions\nyou can use in your templates."),Object(o.b)("ol",{start:2},Object(o.b)("li",{parentName:"ol"},"Markup the template")),Object(o.b)("p",null,"Now, add the control to the template:  "),Object(o.b)("p",null,Object(o.b)("img",{alt:"decorated docx template",src:n(134).default}),"\n(download: ",Object(o.b)("a",{target:"_blank",href:n(135).default},"personal_data_sheet_v1_3-template.docx"),")"),Object(o.b)("ol",{start:3},Object(o.b)("li",{parentName:"ol"},"Add maven dependency")),Object(o.b)("p",null,"Maven:"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-xml"},"  <dependency>\n    <groupId>net.videki.template-utils</groupId>\n    <artifactId>template-utils-core</artifactId>\n    <version>1.0.1</version>\n  </dependency>\n")),Object(o.b)("p",null,"Gradle:"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-groovy"},"  compile group: 'net.videki.template-utils', name: 'template-utils-core', version: '1.0.1'\n")),Object(o.b)("ol",{start:4},Object(o.b)("li",{parentName:"ol"},"Add the generator config (template-utils.properties) to the project resources")),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-properties"},"# Document structure repository provider\nrepository.documentstructure.provider=net.videki.templateutils.template.core.provider.documentstructure.repository.filesystem.FileSystemDocumentStructureRepository\nrepository.documentstructure.builder=net.videki.templateutils.template.core.provider.documentstructure.builder.yaml.YmlDocStructureBuilder\nrepository.documentstructure.provider.basedir=documentstructures\n\n# Template repository provider class\nrepository.template.provider=net.videki.templateutils.template.core.provider.templaterepository.filesystem.FileSystemTemplateRepository\nrepository.template.provider.basedir=templates\n\n# InputTemplate processors\nprocessors.docx=net.videki.templateutils.template.core.processor.input.docx.DocxStamperInputTemplateProcessor\nprocessors.xlsx=net.videki.templateutils.template.core.processor.input.xlsx.JxlsInputTemplateProcessor\n\n# Result repository provider class\nrepository.result.provider=net.videki.templateutils.template.core.provider.resultstore.filesystem.FileSystemResultStore\nrepository.result.provider.basedir=generated-documents\n\n# Font base directory\nconverter.pdf.font-library.basedir=/fonts\n")),Object(o.b)("p",null,"(download: ",Object(o.b)("a",{target:"_blank",href:n(136).default},"template-utils.properties"),")"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"The ",Object(o.b)("code",null,"repository.documentstructure.provider.basedir")," property specifies the template root location.\nThis can be also set to an external location containing the templates.",Object(o.b)("br",{parentName:"li"}),"There is a helper class to handle folders within this doc root and provide full path for the template as shown\nin the code below (see ",Object(o.b)("code",null,"FileSystemHelper.getFileNameWithPath(inputDir, fileName)"),")."),Object(o.b)("li",{parentName:"ul"},"The ",Object(o.b)("code",null,"repository.result.provider.basedir")," property specifies the result root location.\nBy default the basedir root is the output dir with the template name.\nThis can be overridden by specifying the generation behaviour with ",Object(o.b)("code",null,"DocumentStructure"),".")),Object(o.b)("ol",{start:5},Object(o.b)("li",{parentName:"ol"},"Add the document generator functionality to the business logic")),Object(o.b)("p",null,"The sample code below shows a simple fill-and-save scenario to the output dir, but the result can also be requested\nas a stream. See the ",Object(o.b)("code",null,"TemplateService")," interface for more information."),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-java"},'package net.videki.templateutils.examples;\n\nimport net.videki.templateutils.examples.singletemplatepojo.dto.Person;\nimport net.videki.templateutils.template.core.service.TemplateServiceRegistry;\nimport net.videki.templateutils.template.core.service.exception.TemplateServiceException;\nimport net.videki.templateutils.template.core.util.FileSystemHelper;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\nimport java.time.LocalDate;\nimport java.time.Month;\n\npublic class SingleTemplateDocxPojo {\n    private static final Logger LOGGER = LoggerFactory.getLogger(SingleTemplateDocxPojo.class);\n\n    // Only to demonstrate the usage  \n    public static void main(String[] args) {\n        final SingleTemplateDocxPojo appService = new SingleTemplateDocxPojo();\n\n        appService.generateDocs();\n    }\n\n    public void generateDocs() {\n        final String inputDir = "hr-files";\n        final String fileName = "personal_data_sheet_v1_3-template.docx";\n\n        final var data = getTemplateData();\n\n        try {\n            TemplateServiceRegistry.getInstance().fillAndSave(\n                    FileSystemHelper.getFileNameWithPath(inputDir, fileName),\n                    data);\n\n        } catch (final TemplateServiceException e) {\n            LOGGER.error("Error generating the result doc.", e);\n        }\n\n    }\n\n    private Person getTemplateData() {\n        // Mocking the business logic\n        return new Person("John Doe",\n                LocalDate.of(1970, Month.JULY, 20),\n                LocalDate.of(2020, Month.NOVEMBER, 1));\n    }\n}\n')),Object(o.b)("p",null,"Done."),Object(o.b)("h2",{id:"dealing-with-multiple-documents-in-a-workflow"},"Dealing with multiple documents in a workflow"),Object(o.b)("p",null,"In many cases more than one document has to be generated in a workflow. To support this, we introduced\ndocument structures to be handled by the engine. The idea is to collect data during the workflow and generate the\nrequired documents based on the actual data in a single step at the end of the process (this also ensures that at the\nend of the process only the required set of documents will be generated with up to date content, instead of\nre-generating and filtering previously processed results).  "),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"Showcase")),Object(o.b)("p",null,"Suppose we are writing a software for a phone provider company, and our task is to generate contract documents\nfor new clients. Due legal purposes the contracts have to be signed by the clients personally at the company's\nseller offices. These offices have multiple teller desks sharing one multifunctional printer per office."),Object(o.b)("p",null,"The contract consists of the following parts:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"the customer contract itself (contains client and officer data)"),Object(o.b)("li",{parentName:"ul"},"conditions and fees (contains client data)"),Object(o.b)("li",{parentName:"ul"},"terms of use (static text)")),Object(o.b)("p",null,"The contract depends on the client's nationality. If a contract with the client's language is available,\nthat one shall be used, english otherwise. All other documents have to be generated in the given format.\nThe document headers should contain the office, and the officer reference with each page having a QR code\nwith a link pointing to the client's profile in company's CRM.\nTo separate the handouts a cover page has to be printed for all contract with the officer's name, and\nthe generation time."),Object(o.b)("p",null,"So, in our case the documents for an officer should look like below:"),Object(o.b)("ol",null,Object(o.b)("li",{parentName:"ol"},Object(o.b)("p",{parentName:"li"},"Cover page\n",Object(o.b)("img",{alt:"cover page",src:n(137).default}))),Object(o.b)("li",{parentName:"ol"},Object(o.b)("p",{parentName:"li"},"Contract\n",Object(o.b)("img",{alt:"contract",src:n(138).default}),"\n")),Object(o.b)("li",{parentName:"ol"},Object(o.b)("p",{parentName:"li"},"Terms\n",Object(o.b)("img",{alt:"terms",src:n(139).default})))),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"In our case the following document structure can be used:")),Object(o.b)("p",null,"(note: the ids given are generated uuid-s, but you can use any according to the actual needs)"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-yaml"},'# contract_v02.yml\n---\ndocumentStructureId: "109a562d-8290-407d-98e1-e5e31c9808b7"\nelements:\n  - templateElementId:\n      id: "cover"\n    templateNames:\n      hu_HU: "/covers/cover_v03.docx"\n    defaultLocale: "hu_HU"\n    count: 1\n  - templateElementId:\n      id: "contract"\n    templateNames:\n      en: "/contracts/vintage/contract_v09_en.docx"\n      hu: "/contracts/vintage/contract_v09_hu.docx"\n    defaultLocale: "hu_HU"\n    count: 1\n  - templateElementId:\n      id: "terms"\n    templateNames:\n      hu: "/term/terms_v02.docx"\n    defaultLocale: "hu_HU"\n    count: 1\n  - templateElementId:\n      id: "conditions"\n    templateNames:\n      hu: "/conditions/vintage/conditions_eco_v11.xlsx"\n    defaultLocale: "hu_HU"\n    count: 1\nresultMode: "SEPARATE_DOCUMENTS"\noutputFormat: "UNCHANGED"\ncopies: 1\n\n')),Object(o.b)("p",null,"Generating the actual result can be done like below:"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-java"},"        try {\n            final DocumentStructure structure = getContractDocStructure();\n\n            final var tranId = UUID.randomUUID().toString();\n\n            final ValueSet values = new ValueSet(structure.getDocumentStructureId(), tranId);\n            values.getValues().put(TemplateElementId.getGlobalTemplateElementId(), getContractTestData(tranId));\n\n            result = ts.fillAndSave(structure, values);\n\n        } catch (final TemplateNotFoundException | TemplateServiceException e) {\n            testResult = false;\n        }\n")),Object(o.b)("p",null,"Well, that's it."))}u.isMDXComponent=!0},90:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return b}));var a=n(0),r=n.n(a);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=r.a.createContext({}),u=function(e){var t=r.a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=u(e.components);return r.a.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},m=r.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,s=c(e,["components","mdxType","originalType","parentName"]),p=u(n),m=a,b=p["".concat(l,".").concat(m)]||p[m]||d[m]||o;return n?r.a.createElement(b,i(i({ref:t},s),{},{components:n})):r.a.createElement(b,i({ref:t},s))}));function b(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,l=new Array(o);l[0]=m;var i={};for(var c in t)hasOwnProperty.call(t,c)&&(i[c]=t[c]);i.originalType=e,i.mdxType="string"==typeof e?e:a,l[1]=i;for(var s=2;s<o;s++)l[s]=n[s];return r.a.createElement.apply(null,l)}return r.a.createElement.apply(null,n)}m.displayName="MDXCreateElement"}}]);